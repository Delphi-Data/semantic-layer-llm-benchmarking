semantic_models:
  - name: party
    model: ref('party')
    description: "A table containing party information, including names, active dates, and types."
    defaults:
      agg_time_dimension: begin_date  # Assuming Begin_Date is the most relevant time dimension for aggregation 

    entities:
      - name: party
        type: primary
        description: specifies either for agents as agent_id or policy_holders as policyholder_id depending on the value of party_role_code
        expr: Party_Identifier

    dimensions:
      - name: party_name
        type: categorical
        expr: Party_Name

      - name: begin_date
        type: time
        type_params:
          time_granularity: day
        expr: Begin_Date

      - name: end_date
        type: time
        type_params:
          time_granularity: day
        expr: End_Date

      - name: party_type_code
        type: categorical
        description: if party_type_code = "PH" then Party_Identifier refers to policy_holder_id, if party_type_code = "AG" then Party_Identifier refers to agent_id
        expr: Party_Type_Code
